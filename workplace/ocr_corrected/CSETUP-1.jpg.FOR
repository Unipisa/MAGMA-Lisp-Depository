      SUBROUTINE CSETUP
      IMPLICIT INTEGER(A-Z)
      COMMON /LISTT/LISTT/NIL/NIL/NTYPEE/NTYPEE/SNUM/SNUM/EXES/EXES
      COMMON /NEVALV/NEVALV
      INTEGER*2 LISTT,TIP,SNUM,NENTPO
C------------------------------------------------------------------------
      INTEGER*2 INDMAX
      COMMON / INDMAX / INDMAX
      COMMON / BBBBBB / B
      COMMON / BINSTK / BINSTK(1024)
      COMMON / DDNARG/ DDNARG
C------------------------------------------------------------------------
      COMMON /CAR/ADV1(3),CARO,CAR(15767)/CDE/ADV2(3),CDRO,CDR(15767)
      COMMON /BINSP/BINSPL,BINSPO,BINSP(1023)
      COMMON /CBLOCK/ADV3(3),CBLOCK(4096)/CPOINT/CPOINT
      DIMENSION SONBRO(1),BLINK(1),INF(1),NREENT(1),VALORE(1)
      EQUIVALENCE (CBLOCK(1),SONBRO(1)),(CBLOCK(4),BLINK(1))
     *      ,(CBLOCK(2),NREENT(1)),(CBLOCK(3),INF(1))
      EQUIVALENCE (CBLOCK(3),VALORE(1))
      COMMON /ALMODE/ALMODE/NENTPO/NENTPO/UNNO/UNNO
      COMMON /SWIRET/SWIRET
      COMMON /COMPFN/COMPFN
      COMMON /MMFLAG/MMFLAG
C
C==XXX
C    MODIFICHE 29/04/80
C==XXX
C
C==> INIZIALIZZA 'B'
C
C     WRITE(6,123) CPOINT,NENTPO
123   FORMAT(1X,2(Z8,2X))
      B = 0
      CALL GETARG
      FELLON=CPOINT
C     WRITE(6,125) BLINK(FELLON)
125   FORMAT('BLINK(FELLON)= ', Z8)
C     WRITE(6,123) CPOINT,NENTPO
C
C==> GLI ARGOMENTI SI TROVANO GIA' SULLO STACK
      B = INDMAX
      SAVE = INDMAX + 1
C  DETERMINAZIONE NUMERO DI ARGOMENTI
      INDMAX = 2
      BINSTK(SAVE) = CAR(INF(CPOINT))
      BINSTK(SAVE+1) = DDNARG
      CALL GETPF
      B = 0
C   ALLINEAMENTO DELLO STACK AL NUMERO PREVISTO DI ARGOMENTI
      IF (NEVALV.EQ.NIL.OR.NEVALV/NTYPEE.NE.SNUM) GOTO 200
      INDMAX = NEVALV - EXES
      DO 110 I = SAVE,INDMAX
110   BINSTK(B + I) = NIL
C  PREDISPOSIZIONE NOME FUNZIONE