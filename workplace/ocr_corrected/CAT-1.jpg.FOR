C     RACCOLTA DEGLI ATOMI
C
      SUBROUTINE CAT
      IMPLICIT INTEGER(A-Z)
      DOUBLE PRECISION PRINO,NPRINA,PUNTI
      COMMON
     */NTYPEE/ NTYPEE
     */ ALIST / ALIST (128)
     */ APUNT / APU,APUNT(1023)
     */ ATNAME / ATN,ATNAME(1023)
     */ ATMLUN / ATMLUN
     */ LIBAT / LIBAT
     */ LZATOM /LZATOM
     */ PUNTI / PUNTI(4)
     */VALUE/A1(4),VALUE(1023)
     */NPRINA/A4(4),PRINO,NPRINA(1023)
     */KAT/KAT
     */SYSAT/ SYSAT(30)
     */KGBC / KGBC
      DATA M2/Z7FFFFFFF/, M1 /Z80000000/
C
C
C--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
C   SI FORZA LA MARCA DI NON RACCOLTA
C   SU ALCUNI ATOMI .
C--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
C
      DO 560 K = 1,30
124   IF(SYSAT(K).EQ.0) GOTO 125
      KK=MOD(SYSAT(K),NTYPEE)
      VALUE(KK)=IOR(VALU(KK),M1)
560   CONTINUE
C
C--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
C   SGANCIAMENTO ATOMI LIBERI
C   RICOSTRUZIONE LISTA ATOMI UTILI
C--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
C
125   DO 10 J = 1,128
      KK = -1
      I = ALIST(J)
20    IF(I.EQ.-1) GO TO 10
25    IF(VALUE(I).GT.0) GO TO 30
      IF(KK.NE.-1) GOTO 40
      ALIST(J)=I
      GOTO 45
40    APUNT(KK)=I
45    KK = I
      I = APUNT(I)
      GO TO 20
30    IF(KK.EQ.-1) GOTO 12
      IF(APUNT(I).NE.-1) GOTO 13
      APUNT(KK)=-1
      GOTO 10
12    IF(APUNT(I).NE.-1) GOTO 13