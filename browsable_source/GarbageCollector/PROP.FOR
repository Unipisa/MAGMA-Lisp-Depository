      SUBROUTINE PROP(PP,POUT,NP)
C     MARCATURA DELLE LISTE DI PROPRIETA' ;
C     POUT=0: LA P-LIST ESISTE ANCORA;
C     POUT=1: LA P-LIST E' STATA ELIMINATA;
C     NP E' IL PUNTATORE AGGIORNATO.
      IMPLICIT INTEGER (A-Z)
      INTEGER*2 REDEFT, ATOMT
      COMMON
     */CAR/A(4),CAR(5000)
     */ATOMT/ATOMT
     */CDR/B(4),CDR(5000)
     */VALUE/C(4),VALUE(5000)
     */NIL/NIL
     */REDEFT/REDEFT
     */NTYPEE/NTYPEE
      DATA M1/Z80000000/
      DATA M2/Z7FFFFFFF/
      POUT=0
      NP=PP
      V=-1
1     P=NP
      Q=CDR(P)
3     IF(CAR(Q).NE.NIL) GO TO 4
C
C     PROPRIETA' NIL: LA COPPIA VIENE ELIMINATA
8     IF(V.LT.O) GO TO 5
      CDR(V)=CDR(Q)
      IF(CDR(Q).EQ.NIL) RETURN
      GO TO 10
5     IF(CDR(Q).EQ.NIL) GO TO 6
      NP=CDR(Q)
      GO TO 1
6     POUT=1
      RETURN
4     CONTINUE
      IF (CAR(Q).LT.0) GOTO 126
      CALL TEST(CAR(Q),OUTT1,OUTT2)
      IF(OUTT1.EQ.0) GO TO 11
      CAR(Q)=OUTT2
11    MAR=CAR(Q)/NTYPER
      IF (MAR.NE.REDEFT) GO TO 20
      K=MOD(CAR(Q),NTYPEE)
C
C     ESISTE IN RVL DI CAR(Q) UN VALORE DIVERSO DA NIL?
9     IF(CDR(IAND(CAR(K),M2)).NE.NIL) GO TO 20
      IF(CDR(K).EQ.NIL) GO TO 21
      K=CDR(K)
      GO TO 9
21    K=MOD(CAR(Q),NTYPEE)
C
C     LA RVL VIENE SMARCATA PERCHE' DEVE ESSERE RACCOLTA
22    CAR(K)=IAND(CAR(K),M2)
      CAR(CAR(K)) =IAND(CAR(CAR(K)),M2)
      IF(CDR(K).EQ.NIL) GO TO 8 
      K=CDR (K)
      GO TO 22
C
C     LA PROPRIETÃ€' NON E' NIL: LA COPPIA VIENE MARCATA
20       CONTINUE
      IF(CAR(P).LT.O) GO TO 126
      IF(CAR(P)/NTYPEE.EQ REDEFT) GOTO 126
      CALL TEST(CAR(P),OUTT1,OUTT2)
         CAR(P)=IOR(CAR(P),M1)
       CAR(Q) = IOR(CAR(Q),M1)
C
C     SI PASSA AD ESAMINARE LA COPPIA SUCCESSIVA
      IF(CDR(Q).EQ.NIL)  RETURN
      V=Q
10    P=CDR(V)
      Q=CDR(P)
      GO TO 3
126   WRITE(6,127)
127   FORMAT(' SYSTEM ERROR - PROP')
      CALL HLT
      RETURN
      END
